<div class="admin-container">
  <header class="header">
    <div class="header-content">
      <h1>KANINI BANK - Admin Dashboard</h1>
      <div class="header-actions">
        <span class="user-info"
          >Welcome, {{ authService.getCurrentUser()?.fullName }}</span
        >
        <button class="btn btn-secondary" (click)="logout()">Logout</button>
      </div>
    </div>
  </header>

  <nav class="nav-tabs">
    <a routerLink="/admin/dashboard" routerLinkActive="active">Dashboard</a>
    <a routerLink="/admin/customers" routerLinkActive="active">Customers</a>
    <a routerLink="/admin/accounts" routerLinkActive="active">Accounts</a>
  </nav>

  <main class="main-content">
    <div class="stats-grid" *ngIf="stats">
      <div class="stat-card">
        <div class="stat-icon customers">üë•</div>
        <div class="stat-content">
          <h3>Total Customers</h3>
          <p class="stat-value">{{ stats.totalCustomers }}</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon accounts">üè¶</div>
        <div class="stat-content">
          <h3>Total Accounts</h3>
          <p class="stat-value">{{ stats.totalAccounts }}</p>
          <p class="stat-sub">Active: {{ stats.activeAccounts }}</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon deposits">üí∞</div>
        <div class="stat-content">
          <h3>Total Deposits</h3>
          <p class="stat-value">
            ‚Çπ{{ stats.totalDeposits | number : "1.2-2" }}
          </p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon transactions">üìä</div>
        <div class="stat-content">
          <h3>Total Transactions</h3>
          <p class="stat-value">{{ stats.totalTransactions }}</p>
          <p class="stat-sub">Today: {{ stats.todayTransactions }}</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon volume">üíµ</div>
        <div class="stat-content">
          <h3>Today's Volume</h3>
          <p class="stat-value">
            ‚Çπ{{ stats.todayTransactionVolume | number : "1.2-2" }}
          </p>
        </div>
      </div>
    </div>

    <div class="actions-section">
      <h2>Quick Actions</h2>
      <div class="action-buttons">
        <button class="btn btn-primary" (click)="openCustomerModal()">
          <span>‚ûï</span> Create New Customer
        </button>
        <button
          class="btn btn-primary"
          (click)="openTransactionModal('deposit')"
        >
          <span>üí≥</span> Process Deposit
        </button>
        <button
          class="btn btn-primary"
          (click)="openTransactionModal('withdraw')"
        >
          <span>üí∏</span> Process Withdrawal
        </button>
      </div>
    </div>

    <div class="customers-section">
      <h2>Recent Customers</h2>
      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>Full Name</th>
              <th>Username</th>
              <th>Email</th>
              <th>Phone</th>
              <th>Created At</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let customer of customers.slice(0, 5)">
              <td>{{ customer.fullName }}</td>
              <td>{{ customer.username }}</td>
              <td>{{ customer.email }}</td>
              <td>{{ customer.phoneNumber }}</td>
              <td>{{ customer.createdAt | date : "short" }}</td>
              <td>
                <button
                  class="btn btn-sm btn-success"
                  (click)="openAccountModal(customer.id)"
                >
                  Create Account
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </main>
</div>

<!-- Customer Modal -->
<div class="modal" *ngIf="showCustomerModal">
  <div class="modal-content">
    <h2>Create New Customer</h2>
    <form (ngSubmit)="createCustomer()">
      <div class="form-group">
        <label>Full Name</label>
        <input
          type="text"
          [(ngModel)]="customerForm.fullName"
          name="fullName"
          required
          class="form-control"
        />
      </div>
      <div class="form-group">
        <label>Username</label>
        <input
          type="text"
          [(ngModel)]="customerForm.username"
          name="username"
          required
          class="form-control"
        />
      </div>
      <div class="form-group">
        <label>Email</label>
        <input
          type="email"
          [(ngModel)]="customerForm.email"
          name="email"
          required
          class="form-control"
        />
      </div>
      <div class="form-group">
        <label>Phone Number</label>
        <input
          type="text"
          [(ngModel)]="customerForm.phoneNumber"
          name="phone"
          required
          class="form-control"
        />
      </div>
      <div class="form-group">
        <label>Password</label>
        <input
          type="password"
          [(ngModel)]="customerForm.password"
          name="password"
          required
          class="form-control"
        />
      </div>
      <div class="modal-actions">
        <button type="submit" class="btn btn-primary">Create</button>
        <button
          type="button"
          class="btn btn-secondary"
          (click)="closeCustomerModal()"
        >
          Cancel
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Account Modal -->
<div class="modal" *ngIf="showAccountModal">
  <div class="modal-content">
    <h2>Create New Account</h2>
    <form (ngSubmit)="createAccount()">
      <div class="form-group">
        <label>Account Type</label>
        <select
          [(ngModel)]="accountForm.accountType"
          name="accountType"
          class="form-control"
        >
          <option value="SAVINGS">Savings Account</option>
          <option value="CURRENT">Current Account</option>
        </select>
      </div>
      <div class="modal-actions">
        <button type="submit" class="btn btn-primary">Create Account</button>
        <button
          type="button"
          class="btn btn-secondary"
          (click)="closeAccountModal()"
        >
          Cancel
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Transaction Modal -->
<div class="modal" *ngIf="showTransactionModal">
  <div class="modal-content">
    <h2>
      {{
        transactionType === "deposit" ? "Process Deposit" : "Process Withdrawal"
      }}
    </h2>
    <form (ngSubmit)="processTransaction()">
      <div class="form-group">
        <label>Account Number</label>
        <input
          type="text"
          [(ngModel)]="transactionForm.accountNumber"
          name="accountNumber"
          required
          class="form-control"
        />
      </div>
      <div class="form-group">
        <label>Amount</label>
        <input
          type="number"
          [(ngModel)]="transactionForm.amount"
          name="amount"
          required
          min="0.01"
          step="0.01"
          class="form-control"
        />
      </div>
      <div class="form-group">
        <label>Description (Optional)</label>
        <input
          type="text"
          [(ngModel)]="transactionForm.description"
          name="description"
          class="form-control"
        />
      </div>
      <div class="modal-actions">
        <button type="submit" class="btn btn-primary">Process</button>
        <button
          type="button"
          class="btn btn-secondary"
          (click)="closeTransactionModal()"
        >
          Cancel
        </button>
      </div>
    </form>
  </div>
</div>
